Hamiltonian = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
               0, 14000, 70, 6, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
               0, 70, 14000, 13, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
               0, 6, 13, 14000, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
               0, 13, 6, 70, 14000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
               0, 0, 0, 0, 0, 28000, 13, 6, 13, 6, 0, 0, 0, 0, 0, 0;
               0, 0, 0, 0, 0, 13, 28000, 70, 0, 70, 13, 0, 0, 0, 0,0;
               0, 0, 0, 0, 0, 6, 70, 28000, 70, 0, 6, 0, 0, 0, 0, 0;
               0, 0, 0, 0, 0, 13, 0, 70, 28000, 70, 13, 0, 0, 0, 0, 0;
               0, 0, 0, 0, 0, 6, 70, 0, 70, 28000, 6, 0, 0, 0, 0, 0;
               0, 0, 0, 0, 0, 0,  13, 6, 13, 6, 28000, 0, 0, 0, 0, 0;
               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42000, 13, 70, 6, 0;
               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 42000, 6, 70, 0;
               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 70, 6, 42000, 13, 0;
               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 70, 13, 42000, 0;
               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 56000]

[WSCP_Tik_Vek_h, WSCP_Tik_Reik_h] = eig(Hamiltonian)

Dipolio_matrica = [0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
                   1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0;
                   1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0;
                   1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0;
                   1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0;
                   0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0;
                   0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0;
                   0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0;
                   0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0;
                   0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0;
                   0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0;
                   0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1;
                   0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1;
                   0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1;
                   0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1;
                   0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0]

WSCP_trans_tik_vek_h = transpose(WSCP_Tik_Vek_h);

Dipolio_mat_tik_vek_H_baz = WSCP_trans_tik_vek_h*Dipolio_matrica*WSCP_Tik_Vek_h;

D_M_H = Dipolio_mat_tik_vek_H_baz;
H_T_R = WSCP_Tik_Reik_h


w_1 = 27500:1:28500;
w_2 = 13500:1:14500;
[W_1, W_2]= meshgrid(w_1, w_2);
G = 0;
for n = 2:5
    for j = 6:11
        for s = 2:5
             H_1 = H_T_R(j,j) - H_T_R(1,1);
             H_2 = H_T_R(s,s) - H_T_R(1,1);
             H_3 = H_T_R(j,j) - H_T_R(s,s);
             G = G + real(( ( (D_M_H(1,s)*D_M_H(s,j)*D_M_H(j,n)*D_M_H(n,1))./(  ((1i*W_1 - 1i*H_1) - 20) .* ((1i*W_2 - 1i*H_2) -  20) ) ) 
             - ( (D_M_H(1,s)*D_M_H(s,1)*D_M_H(j,n)*D_M_H(n,1))./(((1i*W_1 - 1i*H_1) - 20).*((1i*W_2 - 1i*H_3) -  20) ) )));
             
             
         end
     end     
 end
 
 maxG = max(max(abs(G)));
 contour(w_1, w_2, (asinh(G/maxG)*100), 30) 
